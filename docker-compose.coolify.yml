services:
  moltbot:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: moltbot
    restart: unless-stopped
    command: >-
      /bin/sh -c "node dist/index.js config set gateway.trustedProxies '[\"loopback\",\"linklocal\",\"uniquelocal\",\"10.0.0.0/8\",\"172.16.0.0/12\",\"192.168.0.0/16\"]' && node dist/index.js gateway --bind lan --port 18789 --allow-unconfigured"
    environment:
      - NODE_ENV=production
      - CLAWDBOT_GATEWAY_TOKEN=${CLAWDBOT_GATEWAY_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
    volumes:
      - moltbot_data:/home/node/.clawdbot
      - moltbot_workspace:/home/node/clawd

volumes:
  moltbot_data:
  moltbot_workspace:
